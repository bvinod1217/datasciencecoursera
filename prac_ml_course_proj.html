<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta charset="utf-8"/>

<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
<link rel="stylesheet" href="base.min.css"/>
<link rel="stylesheet" href="fancy.min.css"/>
<link rel="stylesheet" href="main.css"/>
<script src="compatibility.min.js"></script>
<script src="theViewer.min.js"></script>
<script>
try{
theViewer.defaultViewer = new theViewer.Viewer({});
}catch(e){}
</script>
<title></title>
</head>
<body>
<div id="sidebar">
<div id="outline">
</div>
</div>
<div id="page-container">
<div id="pf1" class="pf w0 h0" data-page-no="1"><div class="pc pc1 w0 h0"><img class="bi x0 y0 w1 h1" alt="" src="bg1.png"/><div class="t m0 x1 h2 y1 ff1 fs0 fc0 sc0 ls0 ws0">Practical<span class="_ _0"> </span>Mac<span class="_ _1"></span>hine<span class="_ _0"> </span>Learning<span class="_ _0"> </span>Pro<span class="_ _2"></span>j</div><div class="t m0 x2 h3 y2 ff2 fs1 fc1 sc0 ls0 ws0">library<span class="ff3 fc0">(caret,<span class="fc1">warn.conflicts=</span>F,<span class="fc1">verbose=</span>F,<span class="fc1">quietly=</span>T)</span></div><div class="t m0 x2 h3 y3 ff2 fs1 fc1 sc0 ls0 ws0">library<span class="ff3 fc0">(randomForest,<span class="fc1">warn.conflicts=</span>F,<span class="fc1">verbose=</span>F,<span class="fc1">quietly=</span>T)</span></div><div class="t m0 x2 h3 y4 ff2 fs1 fc1 sc0 ls0 ws0">library<span class="ff3 fc0">(glmnet,<span class="fc1">warn.conflicts=</span>F,<span class="fc1">verbose=</span>F,<span class="fc1">quietly=</span>T)</span></div><div class="t m0 x2 h3 y5 ff2 fs1 fc1 sc0 ls0 ws0">library<span class="ff3 fc0">(nnet,<span class="fc1">warn.conflicts=</span>F,<span class="fc1">verbose=</span>F,<span class="fc1">quietly=</span>T)</span></div><div class="t m0 x2 h3 y6 ff2 fs1 fc1 sc0 ls0 ws0">library<span class="ff3 fc0">(gbm,<span class="fc1">warn.conflicts=</span>F,<span class="fc1">verbose=</span>F,<span class="fc1">quietly=</span>T)</span></div><div class="t m0 x2 h3 y7 ff2 fs1 fc1 sc0 ls0 ws0">library<span class="ff3 fc0">(kernlab,<span class="fc1">warn.conflicts=</span>F,<span class="fc1">verbose=</span>F,<span class="fc1">quietly=</span>T)</span></div><div class="t m0 x2 h3 y8 ff2 fs1 fc1 sc0 ls0 ws0">setwd<span class="ff3 fc0">(<span class="fc2">&quot;~/Downloads&quot;</span>)</span></div><div class="t m0 x2 h3 y9 ff3 fs1 fc0 sc0 ls0 ws0">train&lt;-<span class="ff2 fc1">read.csv</span>(<span class="fc2">&quot;pml-training.csv&quot;</span>,<span class="fc1">stringsAsFactors=</span>F)</div><div class="t m0 x2 h3 ya ff3 fs1 fc0 sc0 ls0 ws0">test&lt;-<span class="ff2 fc1">read.csv</span>(<span class="fc2">&quot;pml-testing.csv&quot;</span>,<span class="fc1">stringsAsFactors=</span>F)</div><div class="t m0 x2 h3 yb ff3 fs1 fc0 sc0 ls0 ws0">train.feat&lt;-train[,-<span class="ff2 fc1">c</span>(<span class="fc3">1</span>,<span class="fc3">2</span>,<span class="fc3">3</span>,<span class="fc3">4</span>,<span class="fc3">5</span>,<span class="fc3">6</span>,<span class="fc3">7</span>)]</div><div class="t m0 x2 h3 yc ff3 fs1 fc0 sc0 ls0 ws0">train.feat[,-<span class="ff2 fc1">which</span>(<span class="ff2 fc1">colnames</span>(train.feat)==<span class="fc2">&quot;classe&quot;</span>)]&lt;-<span class="ff2 fc1">suppressWarnings</span>(<span class="ff2 fc1">sapply</span>(train.feat[,-<span class="ff2 fc1">which</span>(<span class="ff2 fc1">colnames</span>(train.feat)==<span class="fc2">&quot;classe&quot;</span>)],as.numeric))</div><div class="t m0 x2 h3 yd ff3 fs1 fc0 sc0 ls0 ws0">train.feat$classe&lt;-<span class="ff2 fc1">as.factor</span>(train.feat$classe)</div><div class="t m0 x2 h3 ye ff3 fs1 fc0 sc0 ls0 ws0">train.feat&lt;-train.feat[,<span class="ff2 fc1">sapply</span>(train.feat,function(x)<span class="_ _3"> </span><span class="ff2 fc1">all</span>(!<span class="ff2 fc1">is.na</span>(x)))]</div><div class="t m0 x2 h3 yf ff3 fs1 fc0 sc0 ls0 ws0">index&lt;-<span class="ff2 fc1">sample</span>(<span class="fc3">1</span>:<span class="ff2 fc1">nrow</span>(train.feat),<span class="ff2 fc1">ceiling</span>(.<span class="fc3">6</span>*<span class="ff2 fc1">nrow</span>(train.feat)))</div><div class="t m0 x2 h3 y10 ff3 fs1 fc0 sc0 ls0 ws0">train.feat<span class="fc3">.1</span>&lt;-train.feat[index,]</div><div class="t m0 x2 h3 y11 ff3 fs1 fc0 sc0 ls0 ws0">train.feat<span class="fc3">.2</span>&lt;-train.feat[-index,]</div><div class="t m0 x2 h3 y12 ff3 fs1 fc0 sc0 ls0 ws0">test.feat&lt;-<span class="ff2 fc1">suppressWarnings</span>(<span class="ff2 fc1">sapply</span>(test[,<span class="ff2 fc1">colnames</span>(test)%in%<span class="ff2 fc1">colnames</span>(train.feat)],as.numeric))</div><div class="t m1 x2 h4 y13 ff4 fs1 fc0 sc0 ls0 ws0">The<span class="_ _4"> </span>goal<span class="_ _4"> </span>here<span class="_ _4"> </span>is<span class="_ _4"> </span>to<span class="_ _4"> </span>ﬁt<span class="_ _4"> </span>a<span class="_ _4"> </span>predictiv<span class="_ _1"></span>e<span class="_ _4"> </span>classiﬁer<span class="_ _4"> </span>on<span class="_ _4"> </span>a<span class="_ _4"> </span>set<span class="_ _4"> </span>of<span class="_ _4"> </span>observ<span class="_ _1"></span>ations<span class="_ _4"> </span>from<span class="_ _4"> </span>an<span class="_ _4"> </span>exercise<span class="_ _4"> </span>study<span class="_ _1"></span>.<span class="_ _0"> </span>The<span class="_ _4"> </span>study</div><div class="t m2 x2 h4 y14 ff4 fs1 fc0 sc0 ls0 ws0">in<span class="_ _5"></span>v<span class="_ _5"></span>olv<span class="_ _5"></span>ed<span class="_ _6"> </span>rep<span class="_ _2"></span>eated<span class="_ _7"> </span>observ<span class="_ _1"></span>ations<span class="_ _7"> </span>from<span class="_ _6"> </span>six<span class="_ _6"> </span>individuals,<span class="_ _6"> </span>p<span class="_ _2"></span>erforming<span class="_ _7"> </span>a<span class="_ _6"> </span>v<span class="_ _1"></span>ariety<span class="_ _7"> </span>of<span class="_ _6"> </span>exercises.<span class="_ _8"> </span>F<span class="_ _9"></span>or<span class="_ _7"> </span>each<span class="_ _7"> </span>observ<span class="_ _1"></span>ation</div><div class="t m3 x2 h4 y15 ff4 fs1 fc0 sc0 ls0 ws0">n<span class="_ _5"></span>umerous<span class="_ _6"> </span>meaurmen<span class="_ _5"></span>ts<span class="_ _6"> </span>were<span class="_ _7"> </span>taken<span class="_ _7"> </span>from<span class="_ _6"> </span>accelerometers<span class="_ _6"> </span>on<span class="_ _6"> </span>the<span class="_ _6"> </span>forearm,<span class="_ _6"> </span>b<span class="_ _2"></span>elt,<span class="_ _6"> </span>arm,<span class="_ _6"> </span>and<span class="_ _6"> </span>dumbell.<span class="_ _8"> </span>The<span class="_ _6"> </span>outcome</div><div class="t m1 x2 h4 y16 ff4 fs1 fc0 sc0 ls0 ws0">v<span class="_ _1"></span>ariable<span class="_ _7"> </span>is<span class="_ _6"> </span>one<span class="_ _6"> </span>of<span class="_ _6"> </span>5<span class="_ _7"> </span>classes<span class="_ _6"> </span>of<span class="_ _6"> </span>a<span class="_ _6"> </span>categorical<span class="_ _7"> </span>v<span class="_ _1"></span>ariable<span class="_ _6"> </span>that<span class="_ _6"> </span>describ<span class="_ _2"></span>e<span class="_ _7"> </span>information<span class="_ _7"> </span>on<span class="_ _6"> </span>whether<span class="_ _6"> </span>the<span class="_ _6"> </span>exercise<span class="_ _7"> </span>was</div><div class="t m0 x2 h4 y17 ff4 fs1 fc0 sc0 ls0 ws0">done<span class="_ _7"> </span>correctly<span class="_ _9"></span>.</div><div class="t m1 x2 h4 y18 ff4 fs1 fc0 sc0 ls0 ws0">T<span class="_ _9"></span>o<span class="_ _4"> </span>form<span class="_ _4"> </span>a<span class="_ _4"> </span>classiﬁer,<span class="_ _4"> </span>we<span class="_ _4"> </span>divide<span class="_ _4"> </span>the<span class="_ _4"> </span>data<span class="_ _4"> </span>in<span class="_ _1"></span>to<span class="_ _4"> </span>a<span class="_ _4"> </span>training<span class="_ _4"> </span>and<span class="_ _4"> </span>test<span class="_ _4"> </span>set.<span class="_ _0"> </span>The<span class="_ _4"> </span>training<span class="_ _4"> </span>set<span class="_ _4"> </span>consists<span class="_ _4"> </span>of<span class="_ _4"> </span>19,622</div><div class="t m1 x2 h4 y19 ff4 fs1 fc0 sc0 ls0 ws0">observ<span class="_ _1"></span>ations<span class="_ _6"> </span>and<span class="_ _4"> </span>160<span class="_ _6"> </span>v<span class="_ _1"></span>ariables<span class="_ _4"> </span>(not<span class="_ _6"> </span>all<span class="_ _4"> </span>of<span class="_ _6"> </span>which<span class="_ _6"> </span>can<span class="_ _a"> </span>b<span class="_ _2"></span>e<span class="_ _6"> </span>used<span class="_ _a"> </span>in<span class="_ _6"> </span>assembling<span class="_ _6"> </span>a<span class="_ _a"> </span>classiﬁer)<span class="_ _a"> </span>while<span class="_ _a"> </span>the<span class="_ _a"> </span>test<span class="_ _a"> </span>set</div><div class="t m4 x2 h4 y1a ff4 fs1 fc0 sc0 ls0 ws0">consists<span class="_ _7"> </span>of<span class="_ _6"> </span>20<span class="_ _6"> </span>observ<span class="_ _1"></span>ations.<span class="_ _8"> </span>F<span class="_ _9"></span>or<span class="_ _7"> </span>this<span class="_ _6"> </span>prediction<span class="_ _7"> </span>problem<span class="_ _6"> </span>all<span class="_ _6"> </span>v<span class="_ _1"></span>ariables<span class="_ _6"> </span>w<span class="_ _5"></span>ere<span class="_ _7"> </span>treated<span class="_ _6"> </span>as<span class="_ _6"> </span>numeric<span class="_ _7"> </span>and<span class="_ _7"> </span>features</div><div class="t m3 x2 h4 y1b ff4 fs1 fc0 sc0 ls0 ws0">with<span class="_ _7"> </span>no<span class="_ _6"> </span>non<span class="_ _7"> </span>missing<span class="_ _6"> </span>v<span class="_ _1"></span>alues<span class="_ _7"> </span>in<span class="_ _6"> </span>the<span class="_ _6"> </span>training<span class="_ _7"> </span>set<span class="_ _6"> </span>w<span class="_ _5"></span>ere<span class="_ _7"> </span>remov<span class="_ _1"></span>ed.<span class="_ _8"> </span>F<span class="_ _9"></span>urthermore,<span class="_ _7"> </span>features<span class="_ _6"> </span>with<span class="_ _7"> </span>the<span class="_ _6"> </span>ma<span class="_ _2"></span>jorit<span class="_ _1"></span>y<span class="_ _6"> </span>of<span class="_ _7"> </span>their</div><div class="t m3 x2 h4 y1c ff4 fs1 fc0 sc0 ls0 ws0">observ<span class="_ _1"></span>ations<span class="_ _7"> </span>missing<span class="_ _6"> </span>w<span class="_ _5"></span>ere<span class="_ _7"> </span>remov<span class="_ _1"></span>ed,<span class="_ _6"> </span>resulting<span class="_ _7"> </span>in<span class="_ _6"> </span>only<span class="_ _7"> </span>features<span class="_ _6"> </span>with<span class="_ _6"> </span>all<span class="_ _7"> </span>observ<span class="_ _1"></span>ations<span class="_ _6"> </span>nonmissing<span class="_ _7"> </span>b<span class="_ _2"></span>eing<span class="_ _7"> </span>included.</div><div class="t m3 x2 h4 y1d ff4 fs1 fc0 sc0 ls0 ws0">This<span class="_ _7"> </span>allow<span class="_ _1"></span>ed<span class="_ _6"> </span>all<span class="_ _6"> </span>observ<span class="_ _1"></span>ations<span class="_ _6"> </span>in<span class="_ _6"> </span>the<span class="_ _7"> </span>training<span class="_ _6"> </span>set<span class="_ _6"> </span>to<span class="_ _6"> </span>b<span class="_ _2"></span>e<span class="_ _7"> </span>used<span class="_ _6"> </span>instead<span class="_ _6"> </span>of<span class="_ _7"> </span>removing<span class="_ _7"> </span>lots<span class="_ _6"> </span>of<span class="_ _6"> </span>observ<span class="_ _1"></span>ations<span class="_ _6"> </span>to<span class="_ _7"> </span>include</div><div class="t m0 x2 h4 y1e ff4 fs1 fc0 sc0 ls0 ws0">all<span class="_ _7"> </span>v<span class="_ _1"></span>ariables<span class="_ _6"> </span>as<span class="_ _6"> </span>some<span class="_ _6"> </span>of<span class="_ _6"> </span>the<span class="_ _6"> </span>mo<span class="_ _2"></span>dels<span class="_ _7"> </span>used<span class="_ _6"> </span>b<span class="_ _2"></span>elo<span class="_ _1"></span>w<span class="_ _6"> </span>cannot<span class="_ _6"> </span>handle<span class="_ _6"> </span>missing<span class="_ _6"> </span>v<span class="_ _1"></span>alues<span class="_ _6"> </span>without<span class="_ _6"> </span>separate<span class="_ _6"> </span>imputation.</div><div class="t m1 x2 h4 y1f ff4 fs1 fc0 sc0 ls0 ws0">Despite<span class="_ _b"> </span>the<span class="_ _b"> </span>fact<span class="_ _b"> </span>that<span class="_ _b"> </span>the<span class="_ _b"> </span>observ<span class="_ _1"></span>ations<span class="_ _b"> </span>are<span class="_ _b"> </span>clearly<span class="_ _b"> </span>hierarchical<span class="_ _4"> </span>(as<span class="_ _b"> </span>they<span class="_ _b"> </span>are<span class="_ _b"> </span>rep<span class="_ _2"></span>eated<span class="_ _b"> </span>observ<span class="_ _9"></span>ations<span class="_ _b"> </span>of<span class="_ _b"> </span>an</div><div class="t m2 x2 h4 y20 ff4 fs1 fc0 sc0 ls0 ws0">individual),<span class="_ _7"> </span>we<span class="_ _7"> </span>ignore<span class="_ _6"> </span>this<span class="_ _6"> </span>in<span class="_ _6"> </span>building<span class="_ _6"> </span>a<span class="_ _6"> </span>predictive<span class="_ _7"> </span>mo<span class="_ _2"></span>del<span class="_ _7"> </span>due<span class="_ _7"> </span>to<span class="_ _6"> </span>its<span class="_ _6"> </span>complexity<span class="_ _7"> </span>in<span class="_ _6"> </span>inclusion.<span class="_ _8"> </span>This<span class="_ _7"> </span>obviously</div><div class="t m3 x2 h4 y21 ff4 fs1 fc0 sc0 ls0 ws0">mak<span class="_ _5"></span>es<span class="_ _7"> </span>it<span class="_ _6"> </span>likely<span class="_ _7"> </span>that<span class="_ _7"> </span>the<span class="_ _6"> </span>mo<span class="_ _2"></span>dels<span class="_ _7"> </span>trained<span class="_ _7"> </span>will<span class="_ _6"> </span>b<span class="_ _2"></span>e<span class="_ _7"> </span>ov<span class="_ _1"></span>erﬁtting<span class="_ _7"> </span>the<span class="_ _6"> </span>data<span class="_ _6"> </span>set<span class="_ _7"> </span>b<span class="_ _2"></span>ecause<span class="_ _7"> </span>the<span class="_ _6"> </span>individudals<span class="_ _6"> </span>in<span class="_ _7"> </span>the<span class="_ _6"> </span>test<span class="_ _6"> </span>set</div><div class="t m0 x2 h4 y22 ff4 fs1 fc0 sc0 ls0 ws0">are<span class="_ _7"> </span>diﬀerent,<span class="_ _7"> </span>but<span class="_ _6"> </span>we<span class="_ _7"> </span>pro<span class="_ _2"></span>ceed<span class="_ _7"> </span>in<span class="_ _6"> </span>this<span class="_ _6"> </span>manner<span class="_ _6"> </span>anyw<span class="_ _1"></span>ay<span class="_ _9"></span>.</div><div class="t m5 x2 h4 y23 ff4 fs1 fc0 sc0 ls0 ws0">The<span class="_ _6"> </span>actual<span class="_ _6"> </span>steps<span class="_ _6"> </span>are<span class="_ _6"> </span>to<span class="_ _6"> </span>compare<span class="_ _6"> </span>ﬁve<span class="_ _7"> </span>classiﬁers<span class="_ _6"> </span>on<span class="_ _6"> </span>the<span class="_ _6"> </span>training<span class="_ _6"> </span>set<span class="_ _6"> </span>using<span class="_ _6"> </span>cross<span class="_ _6"> </span>v<span class="_ _1"></span>alidation<span class="_ _6"> </span>to<span class="_ _6"> </span>pick<span class="_ _7"> </span>the<span class="_ _6"> </span>optimal</div><div class="t m6 x2 h4 y24 ff4 fs1 fc0 sc0 ls0 ws0">tuning<span class="_ _6"> </span>parameters.<span class="_ _8"> </span>These<span class="_ _6"> </span>optimal<span class="_ _6"> </span>ﬁve<span class="_ _7"> </span>mo<span class="_ _2"></span>dels<span class="_ _7"> </span>are<span class="_ _6"> </span>then<span class="_ _6"> </span>used<span class="_ _6"> </span>on<span class="_ _a"> </span>a<span class="_ _6"> </span>v<span class="_ _1"></span>alidation<span class="_ _6"> </span>set<span class="_ _6"> </span>to<span class="_ _6"> </span>decide<span class="_ _6"> </span>which<span class="_ _7"> </span>mo<span class="_ _2"></span>del<span class="_ _6"> </span>is<span class="_ _6"> </span>the</div><div class="t m3 x2 h4 y25 ff4 fs1 fc0 sc0 ls0 ws0">b<span class="_ _2"></span>est<span class="_ _7"> </span>based<span class="_ _6"> </span>on<span class="_ _6"> </span>minimizing<span class="_ _6"> </span>prediction<span class="_ _6"> </span>error.<span class="_ _8"> </span>The<span class="_ _6"> </span>split<span class="_ _6"> </span>b<span class="_ _2"></span>et<span class="_ _1"></span>ween<span class="_ _7"> </span>the<span class="_ _6"> </span>training<span class="_ _6"> </span>and<span class="_ _a"> </span>v<span class="_ _1"></span>alidation<span class="_ _6"> </span>set<span class="_ _6"> </span>is<span class="_ _6"> </span><span class="ff5">60%<span class="_ _6"> </span></span>and<span class="_ _6"> </span><span class="ff5">40%</span>.</div><div class="t m2 x2 h4 y26 ff4 fs1 fc0 sc0 ls0 ws0">W<span class="_ _9"></span>e<span class="_ _7"> </span>use<span class="_ _6"> </span>the<span class="_ _6"> </span>resulting<span class="_ _6"> </span>mo<span class="_ _2"></span>del<span class="_ _7"> </span>to<span class="_ _6"> </span>predict<span class="_ _6"> </span>the<span class="_ _6"> </span>cases<span class="_ _6"> </span>on<span class="_ _6"> </span>the<span class="_ _6"> </span>test<span class="_ _6"> </span>set.<span class="_ _8"> </span>The<span class="_ _7"> </span>actual<span class="_ _6"> </span>mo<span class="_ _2"></span>dels<span class="_ _7"> </span>compared<span class="_ _6"> </span>are<span class="_ _6"> </span>a<span class="_ _6"> </span>random</div><div class="t m7 x2 h4 y27 ff4 fs1 fc0 sc0 ls0 ws0">forest,<span class="_ _7"> </span>multinomial<span class="_ _7"> </span>regression,<span class="_ _6"> </span>regularized<span class="_ _6"> </span>multinomial<span class="_ _7"> </span>regression,<span class="_ _6"> </span>SVM,<span class="_ _6"> </span>and<span class="_ _6"> </span>a<span class="_ _6"> </span>b<span class="_ _2"></span>oosted<span class="_ _6"> </span>mo<span class="_ _2"></span>del<span class="_ _7"> </span>with<span class="_ _6"> </span>the<span class="_ _6"> </span>ﬁve</div><div class="t m0 x2 h4 y28 ff4 fs1 fc0 sc0 ls0 ws0">previous<span class="_ _7"> </span>mo<span class="_ _2"></span>dels<span class="_ _6"> </span>as<span class="_ _7"> </span>inputs.</div><div class="t m0 x2 h3 y29 ff2 fs1 fc1 sc0 ls0 ws0">set.seed<span class="ff3 fc0">(<span class="fc3">26</span>)</span></div><div class="t m0 x2 h3 y2a ff3 fs1 fc0 sc0 ls0 ws0">train_control&lt;-<span class="ff2 fc1">trainControl</span>(<span class="fc1">method=<span class="fc2">&quot;cv&quot;</span></span>,<span class="fc1">number=<span class="fc3">10</span></span>)</div><div class="t m0 x2 h5 y2b ff6 fs1 fc4 sc0 ls0 ws0">#random<span class="_ _3"> </span>forest</div><div class="t m0 x2 h3 y2c ff3 fs1 fc0 sc0 ls0 ws0">rf.model&lt;-<span class="ff2 fc1">train</span>(classe~.,<span class="fc1">data=</span>train.feat<span class="fc3">.1</span>,<span class="fc1">method=<span class="fc2">&quot;rf&quot;</span></span>,<span class="fc1">trControl=</span>train_control)</div><div class="t m0 x2 h5 y2d ff6 fs1 fc4 sc0 ls0 ws0">#multinomial<span class="_ _3"> </span>regression</div><div class="t m0 x2 h3 y2e ff3 fs1 fc0 sc0 ls0 ws0">multi.model&lt;-<span class="ff2 fc1">multinom</span>(classe~.,<span class="fc1">data=</span>train.feat<span class="fc3">.1</span>,<span class="fc1">trace=</span>F)</div><div class="t m0 x2 h5 y2f ff6 fs1 fc4 sc0 ls0 ws0">#regularized<span class="_ _3"> </span>multinomial<span class="_ _3"> </span>regression</div><div class="t m0 x3 h4 y30 ff4 fs1 fc0 sc0 ls0 ws0">1</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div></div>
<div id="pf2" class="pf w0 h0" data-page-no="2"><div class="pc pc2 w0 h0"><img class="bi x0 y31 w1 h6" alt="" src="bg2.png"/><div class="t m0 x2 h3 y32 ff3 fs1 fc0 sc0 ls0 ws0">cv.lambda&lt;-<span class="ff2 fc1">cv.glmnet</span>(<span class="ff2 fc1">as.matrix</span>(train.feat<span class="fc3">.1</span>[,-<span class="ff2 fc1">ncol</span>(train.feat<span class="fc3">.1</span>)]),train.feat<span class="fc3">.1</span>$classe,<span class="fc1">family=<span class="fc2">&quot;multinomial&quot;</span></span>)</div><div class="t m0 x2 h3 y33 ff3 fs1 fc0 sc0 ls0 ws0">reg.model&lt;-<span class="ff2 fc1">glmnet</span>(<span class="ff2 fc1">as.matrix</span>(train.feat<span class="fc3">.1</span>[,-<span class="ff2 fc1">ncol</span>(train.feat<span class="fc3">.1</span>)]),train.feat<span class="fc3">.1</span>$classe,<span class="fc1">family=<span class="fc2">&quot;multinomial&quot;</span></span>,<span class="fc1">lambda=</span>cv.lambda$lambda.1se)</div><div class="t m0 x2 h5 y34 ff6 fs1 fc4 sc0 ls0 ws0">#SVM</div><div class="t m0 x2 h3 y35 ff3 fs1 fc0 sc0 ls0 ws0">svm.model&lt;-<span class="ff2 fc1">train</span>(classe~.,<span class="fc1">data=</span>train.feat<span class="fc3">.1</span>,<span class="fc1">method=<span class="fc2">&quot;svmLinear&quot;</span></span>,<span class="fc1">trControl=</span>train_control)</div><div class="t m0 x2 h5 y36 ff6 fs1 fc4 sc0 ls0 ws0">#get<span class="_ _3"> </span>predictions</div><div class="t m0 x2 h3 y37 ff3 fs1 fc0 sc0 ls0 ws0">train.rf&lt;-<span class="ff2 fc1">predict</span>(rf.model)</div><div class="t m0 x2 h3 y38 ff3 fs1 fc0 sc0 ls0 ws0">train.multi&lt;-<span class="ff2 fc1">predict</span>(multi.model)</div><div class="t m0 x2 h3 y39 ff3 fs1 fc0 sc0 ls0 ws0">train.reg&lt;-<span class="ff2 fc1">predict</span>(reg.model,<span class="ff2 fc1">as.matrix</span>(train.feat<span class="fc3">.1</span>[,-<span class="ff2 fc1">ncol</span>(train.feat<span class="fc3">.1</span>)]),<span class="fc1">type=<span class="fc2">&quot;class&quot;</span></span>)</div><div class="t m0 x2 h3 y3a ff3 fs1 fc0 sc0 ls0 ws0">train.svm&lt;-<span class="ff2 fc1">predict</span>(svm.model,<span class="fc1">newdata=</span>train.feat<span class="fc3">.1</span>[,-<span class="ff2 fc1">ncol</span>(train.feat<span class="fc3">.1</span>)])</div><div class="t m0 x2 h5 y3b ff6 fs1 fc4 sc0 ls0 ws0">#boosted<span class="_ _3"> </span>model</div><div class="t m0 x2 h3 y3c ff3 fs1 fc0 sc0 ls0 ws0">combined.dat&lt;-<span class="ff2 fc1">data.frame</span>(<span class="fc2">&quot;Y&quot;</span>=train.feat<span class="fc3">.1</span>$classe,<span class="fc2">&quot;rf&quot;</span>=train.rf,<span class="fc2">&quot;multi&quot;</span>=train.multi,<span class="fc2">&quot;reg&quot;</span>=train.reg,<span class="fc2">&quot;svm&quot;</span>=train.svm)</div><div class="t m0 x2 h3 y3d ff3 fs1 fc0 sc0 ls0 ws0">rf.gbm&lt;-<span class="ff2 fc1">gbm</span>(Y~.,<span class="fc1">data=</span>combined.dat,<span class="fc1">distribution=<span class="fc2">&quot;multinomial&quot;</span></span>,<span class="fc1">cv.folds=<span class="fc3">10</span></span>)</div><div class="t m0 x2 h3 y3e ff3 fs1 fc0 sc0 ls0 ws0">train.gbm&lt;-<span class="ff2 fc1">predict</span>(rf.gbm,<span class="fc1">n.trees=<span class="fc3">100</span></span>,<span class="fc1">type=<span class="fc2">&quot;response&quot;</span></span>)</div><div class="t m0 x2 h3 y3f ff3 fs1 fc0 sc0 ls0 ws0">train.gbm&lt;-<span class="ff2 fc1">apply</span>(train.gbm[,,],<span class="fc3">1</span>,function(x)<span class="_ _3"> </span><span class="ff2 fc1">colnames</span>(train.gbm[,,])[<span class="ff2 fc1">which.max</span>(x)])</div><div class="t m0 x2 h5 y40 ff6 fs1 fc4 sc0 ls0 ws0">#fit<span class="_ _3"> </span>on<span class="_ _3"> </span>validation<span class="_ _3"> </span>set</div><div class="t m0 x2 h3 y41 ff3 fs1 fc0 sc0 ls0 ws0">train2.rf&lt;-<span class="ff2 fc1">predict</span>(rf.model,<span class="fc1">newdata=</span>train.feat<span class="fc3">.2</span>[,-<span class="ff2 fc1">ncol</span>(train.feat<span class="fc3">.2</span>)])</div><div class="t m0 x2 h3 y42 ff3 fs1 fc0 sc0 ls0 ws0">train2.multi&lt;-<span class="ff2 fc1">predict</span>(multi.model,train.feat<span class="fc3">.2</span>[,-<span class="ff2 fc1">ncol</span>(train.feat<span class="fc3">.2</span>)])</div><div class="t m0 x2 h3 y43 ff3 fs1 fc0 sc0 ls0 ws0">train2.reg&lt;-<span class="ff2 fc1">predict</span>(reg.model,<span class="ff2 fc1">as.matrix</span>(train.feat<span class="fc3">.2</span>[,-<span class="ff2 fc1">ncol</span>(train.feat<span class="fc3">.2</span>)]),<span class="fc1">type=<span class="fc2">&quot;class&quot;</span></span>)</div><div class="t m0 x2 h3 y44 ff3 fs1 fc0 sc0 ls0 ws0">train2.svm&lt;-<span class="ff2 fc1">predict</span>(svm.model,<span class="fc1">newdata=</span>train.feat<span class="fc3">.2</span>[,-<span class="ff2 fc1">ncol</span>(train.feat<span class="fc3">.2</span>)])</div><div class="t m0 x2 h3 y45 ff3 fs1 fc0 sc0 ls0 ws0">combined2.dat&lt;-<span class="ff2 fc1">data.frame</span>(<span class="fc2">&quot;rf&quot;</span>=train2.rf,<span class="fc2">&quot;multi&quot;</span>=train2.multi,<span class="fc2">&quot;reg&quot;</span>=train2.reg,<span class="fc2">&quot;svm&quot;</span>=train2.svm)</div><div class="t m0 x2 h3 y46 ff3 fs1 fc0 sc0 ls0 ws0">train2.gbm&lt;-<span class="ff2 fc1">predict</span>(rf.gbm,<span class="fc1">newdata=</span>combined2.dat,<span class="fc1">n.trees=<span class="fc3">100</span></span>,<span class="fc1">type=<span class="fc2">&quot;response&quot;</span></span>)</div><div class="t m0 x2 h3 y47 ff3 fs1 fc0 sc0 ls0 ws0">train2.gbm&lt;-<span class="ff2 fc1">apply</span>(train2.gbm[,,],<span class="fc3">1</span>,function(x)<span class="_ _3"> </span><span class="ff2 fc1">colnames</span>(train2.gbm[,,])[<span class="ff2 fc1">which.max</span>(x)])</div><div class="t m8 x2 h4 y48 ff4 fs1 fc0 sc0 ls0 ws0">The<span class="_ _6"> </span>table<span class="_ _6"> </span>b<span class="_ _2"></span>elo<span class="_ _1"></span>w<span class="_ _6"> </span>shows<span class="_ _7"> </span>the<span class="_ _6"> </span>prediction<span class="_ _6"> </span>accuracy<span class="_ _6"> </span>on<span class="_ _a"> </span>b<span class="_ _2"></span>oth<span class="_ _7"> </span>the<span class="_ _6"> </span>training<span class="_ _6"> </span>set<span class="_ _6"> </span>on<span class="_ _6"> </span>which<span class="_ _7"> </span>the<span class="_ _6"> </span>v<span class="_ _1"></span>arious<span class="_ _a"> </span>mo<span class="_ _2"></span>dels<span class="_ _7"> </span>were<span class="_ _7"> </span>ﬁt</div><div class="t m3 x2 h4 y49 ff4 fs1 fc0 sc0 ls0 ws0">b<span class="_ _5"></span>y<span class="_ _7"> </span>cross<span class="_ _6"> </span>v<span class="_ _1"></span>alidation,<span class="_ _7"> </span>and<span class="_ _6"> </span>the<span class="_ _7"> </span>left<span class="_ _6"> </span>out<span class="_ _7"> </span>“v<span class="_ _1"></span>alidation”<span class="_ _6"> </span>set<span class="_ _7"> </span>that<span class="_ _6"> </span>will<span class="_ _7"> </span>b<span class="_ _2"></span>e<span class="_ _7"> </span>used<span class="_ _6"> </span>for<span class="_ _7"> </span>mo<span class="_ _2"></span>del<span class="_ _7"> </span>selection.<span class="_ _8"> </span>On<span class="_ _7"> </span>the<span class="_ _6"> </span>training<span class="_ _7"> </span>set</div><div class="t m3 x2 h4 y4a ff4 fs1 fc0 sc0 ls0 ws0">trees<span class="_ _7"> </span>and<span class="_ _6"> </span>the<span class="_ _7"> </span>gbm<span class="_ _6"> </span>b<span class="_ _2"></span>oth<span class="_ _7"> </span>ac<span class="_ _1"></span>hieve<span class="_ _7"> </span>p<span class="_ _2"></span>erfect<span class="_ _7"> </span>accuracy<span class="_ _9"></span>,<span class="_ _7"> </span>outp<span class="_ _2"></span>erforming<span class="_ _7"> </span>the<span class="_ _7"> </span>other<span class="_ _6"> </span>metho<span class="_ _2"></span>ds.<span class="_ _b"> </span>Note<span class="_ _6"> </span>the<span class="_ _7"> </span>GBM<span class="_ _6"> </span>only<span class="_ _7"> </span>puts</div><div class="t m4 x2 h4 y4b ff4 fs1 fc0 sc0 ls0 ws0">w<span class="_ _5"></span>eigh<span class="_ _5"></span>t<span class="_ _7"> </span>on<span class="_ _6"> </span>the<span class="_ _6"> </span>random<span class="_ _7"> </span>forest<span class="_ _6"> </span>mo<span class="_ _2"></span>del<span class="_ _7"> </span>output,<span class="_ _6"> </span>which<span class="_ _7"> </span>is<span class="_ _7"> </span>why<span class="_ _7"> </span>its<span class="_ _7"> </span>p<span class="_ _2"></span>erformance<span class="_ _7"> </span>is<span class="_ _6"> </span>identical<span class="_ _7"> </span>to<span class="_ _7"> </span>the<span class="_ _6"> </span>random<span class="_ _6"> </span>forest</div><div class="t m1 x2 h4 y4c ff4 fs1 fc0 sc0 ls0 ws0">mo<span class="_ _2"></span>del.<span class="_ _8"> </span>Based<span class="_ _a"> </span>on<span class="_ _6"> </span>this<span class="_ _a"> </span>we<span class="_ _7"> </span>opt<span class="_ _a"> </span>for<span class="_ _6"> </span>using<span class="_ _a"> </span>the<span class="_ _6"> </span>random<span class="_ _a"> </span>forest<span class="_ _6"> </span>mo<span class="_ _2"></span>del<span class="_ _6"> </span>since<span class="_ _a"> </span>that<span class="_ _6"> </span>is<span class="_ _a"> </span>ultimately<span class="_ _6"> </span>the<span class="_ _a"> </span>metho<span class="_ _2"></span>d<span class="_ _7"> </span>that</div><div class="t m0 x2 h4 y4d ff4 fs1 fc0 sc0 ls0 ws0">p<span class="_ _2"></span>erformed<span class="_ _7"> </span>the<span class="_ _6"> </span>b<span class="_ _2"></span>est<span class="_ _7"> </span>and<span class="_ _6"> </span>use<span class="_ _7"> </span>it<span class="_ _6"> </span>to<span class="_ _6"> </span>predict<span class="_ _6"> </span>the<span class="_ _6"> </span>tw<span class="_ _1"></span>ent<span class="_ _1"></span>y<span class="_ _6"> </span>test<span class="_ _6"> </span>cases.</div><div class="t m0 x2 h5 y4e ff6 fs1 fc4 sc0 ls0 ws0">#computer<span class="_ _3"> </span>accuracy<span class="_ _3"> </span>on<span class="_ _3"> </span>each<span class="_ _3"> </span>data<span class="_ _3"> </span>set</div><div class="t m0 x2 h3 y4f ff3 fs1 fc0 sc0 ls0 ws0">rf&lt;-<span class="ff2 fc1">c</span>(<span class="fc3">100</span>*<span class="ff2 fc1">sum</span>(<span class="ff2 fc1">diag</span>(<span class="ff2 fc1">table</span>(train.rf,train.feat<span class="fc3">.1</span>$classe)))/<span class="ff2 fc1">sum</span>(<span class="ff2 fc1">table</span>(train.rf,train.feat<span class="fc3">.1</span>$classe)),<span class="fc3">100</span>*<span class="ff2 fc1">sum</span>(<span class="ff2 fc1">diag</span>(<span class="ff2 fc1">table</span>(train2.rf,train.feat<span class="fc3">.2</span>$classe)))/<span class="ff2 fc1">sum</span>(<span class="ff2 fc1">table</span>(train2.rf,train.feat<span class="fc3">.2</span>$classe)))</div><div class="t m0 x2 h3 y50 ff3 fs1 fc0 sc0 ls0 ws0">multinomial&lt;-<span class="ff2 fc1">c</span>(<span class="fc3">100</span>*<span class="ff2 fc1">sum</span>(<span class="ff2 fc1">diag</span>(<span class="ff2 fc1">table</span>(train.multi,train.feat<span class="fc3">.1</span>$classe)))/<span class="ff2 fc1">sum</span>(<span class="ff2 fc1">table</span>(train.multi,train.feat<span class="fc3">.1</span>$classe)),<span class="fc3">100</span>*<span class="ff2 fc1">sum</span>(<span class="ff2 fc1">diag</span>(<span class="ff2 fc1">table</span>(train2.multi,train.feat<span class="fc3">.2</span>$classe)))/<span class="ff2 fc1">sum</span>(<span class="ff2 fc1">table</span>(train2.multi,train.feat<span class="fc3">.2</span>$classe)))</div><div class="t m0 x2 h3 y51 ff3 fs1 fc0 sc0 ls0 ws0">reg.multinomial&lt;-<span class="ff2 fc1">c</span>(<span class="fc3">100</span>*<span class="ff2 fc1">sum</span>(<span class="ff2 fc1">diag</span>(<span class="ff2 fc1">table</span>(train.reg,train.feat<span class="fc3">.1</span>$classe)))/<span class="ff2 fc1">sum</span>(<span class="ff2 fc1">table</span>(train.reg,train.feat<span class="fc3">.1</span>$classe)),<span class="fc3">100</span>*<span class="ff2 fc1">sum</span>(<span class="ff2 fc1">diag</span>(<span class="ff2 fc1">table</span>(train2.reg,train.feat<span class="fc3">.2</span>$classe)))/<span class="ff2 fc1">sum</span>(<span class="ff2 fc1">table</span>(train2.reg,train.feat<span class="fc3">.2</span>$classe)))</div><div class="t m0 x2 h3 y52 ff3 fs1 fc0 sc0 ls0 ws0">svm&lt;-<span class="ff2 fc1">c</span>(<span class="fc3">100</span>*<span class="ff2 fc1">sum</span>(<span class="ff2 fc1">diag</span>(<span class="ff2 fc1">table</span>(train.svm,train.feat<span class="fc3">.1</span>$classe)))/<span class="ff2 fc1">sum</span>(<span class="ff2 fc1">table</span>(train.svm,train.feat<span class="fc3">.1</span>$classe)),<span class="fc3">100</span>*<span class="ff2 fc1">sum</span>(<span class="ff2 fc1">diag</span>(<span class="ff2 fc1">table</span>(train2.svm,train.feat<span class="fc3">.2</span>$classe)))/<span class="ff2 fc1">sum</span>(<span class="ff2 fc1">table</span>(train2.svm,train.feat<span class="fc3">.2</span>$classe)))</div><div class="t m0 x2 h3 y53 ff3 fs1 fc0 sc0 ls0 ws0">gbm&lt;-<span class="ff2 fc1">c</span>(<span class="fc3">100</span>*<span class="ff2 fc1">sum</span>(<span class="ff2 fc1">diag</span>(<span class="ff2 fc1">table</span>(train.gbm,train.feat<span class="fc3">.1</span>$classe)))/<span class="ff2 fc1">sum</span>(<span class="ff2 fc1">table</span>(train.gbm,train.feat<span class="fc3">.1</span>$classe)),<span class="fc3">100</span>*<span class="ff2 fc1">sum</span>(<span class="ff2 fc1">diag</span>(<span class="ff2 fc1">table</span>(train2.gbm,train.feat<span class="fc3">.2</span>$classe)))/<span class="ff2 fc1">sum</span>(<span class="ff2 fc1">table</span>(train2.gbm,train.feat<span class="fc3">.2</span>$classe)))</div><div class="t m0 x2 h3 y54 ff3 fs1 fc0 sc0 ls0 ws0">train.accuracy&lt;-<span class="ff2 fc1">data.frame</span>(<span class="fc2">&quot;rf&quot;</span>=rf,<span class="fc2">&quot;multinomial&quot;</span>=multinomial,<span class="fc2">&quot;reg.multinomial&quot;</span>=reg.multinomial,<span class="fc2">&quot;svm&quot;</span>=svm,<span class="fc2">&quot;gbm&quot;</span>=gbm)</div><div class="t m0 x2 h3 y55 ff2 fs1 fc1 sc0 ls0 ws0">rownames<span class="ff3 fc0">(train.accuracy)&lt;-</span>c<span class="ff3 fc0">(<span class="fc2">&quot;train.accuracy&quot;</span>,<span class="fc2">&quot;validation.accuracy&quot;</span>)</span></div><div class="t m0 x2 h3 y56 ff3 fs1 fc0 sc0 ls0 ws0">train.accuracy</div><div class="t m0 x2 h3 y57 ff3 fs1 fc0 sc0 ls0 ws0">##<span class="_ _c"> </span>rf<span class="_ _3"> </span>multinomial<span class="_ _3"> </span>reg.multinomial<span class="_ _d"> </span>svm</div><div class="t m0 x2 h3 y58 ff3 fs1 fc0 sc0 ls0 ws0">##<span class="_ _3"> </span>train.accuracy<span class="_ _d"> </span>100.00000<span class="_ _e"> </span>65.87396<span class="_ _f"> </span>74.00204<span class="_ _3"> </span>79.17445</div><div class="t m0 x2 h3 y59 ff3 fs1 fc0 sc0 ls0 ws0">##<span class="_ _3"> </span>validation.accuracy<span class="_ _10"> </span>98.92966<span class="_ _e"> </span>65.88940<span class="_ _f"> </span>73.72579<span class="_ _3"> </span>78.31295</div><div class="t m0 x2 h3 y5a ff3 fs1 fc0 sc0 ls0 ws0">##<span class="_ _11"> </span>gbm</div><div class="t m0 x2 h3 y5b ff3 fs1 fc0 sc0 ls0 ws0">##<span class="_ _3"> </span>train.accuracy<span class="_ _d"> </span>100.00000</div><div class="t m0 x2 h3 y5c ff3 fs1 fc0 sc0 ls0 ws0">##<span class="_ _3"> </span>validation.accuracy<span class="_ _10"> </span>98.92966</div><div class="t m9 x2 h4 y5d ff4 fs1 fc0 sc0 ls0 ws0">The<span class="_ _6"> </span>tuned<span class="_ _6"> </span>random<span class="_ _6"> </span>forest<span class="_ _6"> </span>mo<span class="_ _2"></span>del<span class="_ _6"> </span>used<span class="_ _6"> </span>chose<span class="_ _7"> </span>a<span class="_ _6"> </span>random<span class="_ _6"> </span>sample<span class="_ _a"> </span>of<span class="_ _6"> </span>27<span class="_ _6"> </span>predictors<span class="_ _6"> </span>to<span class="_ _6"> </span>consider<span class="_ _a"> </span>in<span class="_ _6"> </span>at<span class="_ _6"> </span>each<span class="_ _7"> </span>split<span class="_ _6"> </span>and</div><div class="t m3 x2 h4 y5e ff4 fs1 fc0 sc0 ls0 ws0">here<span class="_ _7"> </span>is<span class="_ _6"> </span>a<span class="_ _7"> </span>plot<span class="_ _6"> </span>for<span class="_ _7"> </span>the<span class="_ _6"> </span>v<span class="_ _1"></span>ariable<span class="_ _7"> </span>imp<span class="_ _2"></span>ortance<span class="_ _7"> </span>across<span class="_ _6"> </span>predictors.<span class="_ _b"> </span>The<span class="_ _6"> </span>results<span class="_ _6"> </span>of<span class="_ _7"> </span>other<span class="_ _6"> </span>mo<span class="_ _2"></span>dels<span class="_ _7"> </span>w<span class="_ _1"></span>ere<span class="_ _6"> </span>omitted<span class="_ _7"> </span>b<span class="_ _2"></span>ecause</div><div class="t m1 x2 h4 y5f ff4 fs1 fc0 sc0 ls0 ws0">they<span class="_ _6"> </span>did<span class="_ _6"> </span>not<span class="_ _a"> </span>p<span class="_ _2"></span>erform<span class="_ _7"> </span>as<span class="_ _a"> </span>w<span class="_ _5"></span>ell<span class="_ _6"> </span>or<span class="_ _6"> </span>were<span class="_ _6"> </span>identical<span class="_ _7"> </span>to<span class="_ _6"> </span>the<span class="_ _a"> </span>random<span class="_ _6"> </span>forest<span class="_ _a"> </span>(in<span class="_ _6"> </span>the<span class="_ _6"> </span>case<span class="_ _a"> </span>of<span class="_ _6"> </span>the<span class="_ _a"> </span>combined<span class="_ _7"> </span>b<span class="_ _2"></span>oosted</div><div class="t m0 x2 h4 y60 ff4 fs1 fc0 sc0 ls0 ws0">mo<span class="_ _2"></span>del).</div><div class="t m0 x3 h4 y30 ff4 fs1 fc0 sc0 ls0 ws0">2</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div></div>
<div id="pf3" class="pf w0 h0" data-page-no="3"><div class="pc pc3 w0 h0"><img class="bi x0 y61 w1 h7" alt="" src="bg3.png"/><div class="t m0 x2 h3 y32 ff2 fs1 fc1 sc0 ls0 ws0">dotPlot<span class="ff3 fc0">(</span>varImp<span class="ff3 fc0">(rf.model))</span></div><div class="c x2 y62 w2 h8"><div class="t m0 x4 h9 y63 ff7 fs2 fc0 sc0 ls0 ws0">Impor<span class="_ _2"></span>tance</div><div class="t m0 x5 ha y64 ff7 fs3 fc0 sc0 ls0 ws0">magnet_belt_x</div><div class="t m0 x6 ha y65 ff7 fs3 fc0 sc0 ls0 ws0">gyros_belt_z</div><div class="t m0 x7 ha y66 ff7 fs3 fc0 sc0 ls0 ws0">ya<span class="_ _1"></span>w_ar<span class="_ _2"></span>m</div><div class="t m0 x8 ha y67 ff7 fs3 fc0 sc0 ls0 ws0">accel_belt_z</div><div class="t m0 x5 ha y68 ff7 fs3 fc0 sc0 ls0 ws0">magnet_belt_y</div><div class="t m0 x9 ha y69 ff7 fs3 fc0 sc0 ls0 ws0">magnet_f<span class="_ _1"></span>orear<span class="_ _2"></span>m_z</div><div class="t m0 xa ha y6a ff7 fs3 fc0 sc0 ls0 ws0">total_accel_dumbbell</div><div class="t m0 xb ha y6b ff7 fs3 fc0 sc0 ls0 ws0">accel_dumbbell_z</div><div class="t m0 x5 ha y6c ff7 fs3 fc0 sc0 ls0 ws0">magnet_belt_z</div><div class="t m0 xc ha y6d ff7 fs3 fc0 sc0 ls0 ws0">magnet_dumbbell_x</div><div class="t m0 xd ha y6e ff7 fs3 fc0 sc0 ls0 ws0">accel_f<span class="_ _1"></span>orear<span class="_ _2"></span>m_x</div><div class="t m0 xe ha y6f ff7 fs3 fc0 sc0 ls0 ws0">roll_dumbbell</div><div class="t m0 xb ha y70 ff7 fs3 fc0 sc0 ls0 ws0">accel_dumbbell_y</div><div class="t m0 xf ha y71 ff7 fs3 fc0 sc0 ls0 ws0">roll_f<span class="_ _1"></span>orear<span class="_ _2"></span>m</div><div class="t m0 x10 ha y72 ff7 fs3 fc0 sc0 ls0 ws0">pitch_belt</div><div class="t m0 xc ha y73 ff7 fs3 fc0 sc0 ls0 ws0">magnet_dumbbell_z</div><div class="t m0 xc ha y74 ff7 fs3 fc0 sc0 ls0 ws0">magnet_dumbbell_y</div><div class="t m0 x11 ha y75 ff7 fs3 fc0 sc0 ls0 ws0">ya<span class="_ _1"></span>w_belt</div><div class="t m0 x12 ha y76 ff7 fs3 fc0 sc0 ls0 ws0">pitch_f<span class="_ _1"></span>orear<span class="_ _2"></span>m</div><div class="t m0 x13 ha y77 ff7 fs3 fc0 sc0 ls0 ws0">roll_belt</div><div class="t m0 x14 ha y78 ff7 fs3 fc0 sc0 ls0 ws0">20<span class="_ _12"> </span>40<span class="_ _12"> </span>60<span class="_ _12"> </span>80<span class="_ _13"> </span>100</div></div><div class="t ma x2 h4 y79 ff4 fs1 fc0 sc0 ls0 ws0">The<span class="_ _6"> </span>most<span class="_ _6"> </span>imp<span class="_ _2"></span>ortan<span class="_ _1"></span>t<span class="_ _6"> </span>v<span class="_ _1"></span>ariable<span class="_ _6"> </span>by<span class="_ _7"> </span>far<span class="_ _6"> </span>is<span class="_ _6"> </span>roll_b<span class="_ _2"></span>elt<span class="_ _7"> </span>Pitch_forearm<span class="_ _7"> </span>and<span class="_ _6"> </span>ya<span class="_ _1"></span>w_b<span class="_ _2"></span>elt<span class="_ _7"> </span>hav<span class="_ _1"></span>e<span class="_ _6"> </span>similar<span class="_ _6"> </span>imp<span class="_ _2"></span>ortance<span class="_ _7"> </span>levels</div><div class="t m0 x2 h4 y7a ff4 fs1 fc0 sc0 ls0 ws0">to<span class="_ _7"> </span>the<span class="_ _6"> </span>next<span class="_ _6"> </span>four<span class="_ _6"> </span>v<span class="_ _1"></span>ariables.<span class="_ _8"> </span>Then<span class="_ _6"> </span>there<span class="_ _6"> </span>is<span class="_ _6"> </span>a<span class="_ _6"> </span>long<span class="_ _6"> </span>right<span class="_ _7"> </span>tail<span class="_ _6"> </span>or<span class="_ _7"> </span>v<span class="_ _1"></span>ariables<span class="_ _6"> </span>with<span class="_ _6"> </span>of<span class="_ _6"> </span>small<span class="_ _6"> </span>imp<span class="_ _2"></span>ortance.</div><div class="t m8 x2 h4 y7b ff4 fs1 fc0 sc0 ls0 ws0">T<span class="_ _9"></span>o<span class="_ _6"> </span>approximate<span class="_ _7"> </span>the<span class="_ _6"> </span>out<span class="_ _6"> </span>of<span class="_ _6"> </span>sample<span class="_ _6"> </span>error,<span class="_ _a"> </span>w<span class="_ _5"></span>e<span class="_ _6"> </span>reﬁt<span class="_ _6"> </span>the<span class="_ _6"> </span>chosen<span class="_ _7"> </span>mo<span class="_ _2"></span>del<span class="_ _7"> </span>(random<span class="_ _a"> </span>forest<span class="_ _6"> </span>with<span class="_ _6"> </span>random<span class="_ _6"> </span>sample<span class="_ _6"> </span>of<span class="_ _a"> </span>27</div><div class="t m3 x2 h4 y7c ff4 fs1 fc0 sc0 ls0 ws0">predictors<span class="_ _6"> </span>considered<span class="_ _6"> </span>at<span class="_ _6"> </span>each<span class="_ _7"> </span>split)<span class="_ _6"> </span>to<span class="_ _a"> </span>the<span class="_ _6"> </span>entire<span class="_ _7"> </span>training<span class="_ _6"> </span>data<span class="_ _6"> </span>and<span class="_ _6"> </span>use<span class="_ _a"> </span>10-fold<span class="_ _6"> </span>cross<span class="_ _6"> </span>v<span class="_ _1"></span>alidation<span class="_ _6"> </span>as<span class="_ _6"> </span>an<span class="_ _6"> </span>estimate</div><div class="t m0 x2 h4 y7d ff4 fs1 fc0 sc0 ls0 ws0">of<span class="_ _7"> </span>test<span class="_ _6"> </span>error.</div><div class="t m0 x2 h3 y7e ff3 fs1 fc0 sc0 ls0 ws0">rf.model.final&lt;-<span class="ff2 fc1">train</span>(classe~.,<span class="fc1">data=</span>train.feat,<span class="fc1">method=<span class="fc2">&quot;rf&quot;</span></span>,<span class="fc1">tuneGrid=<span class="ff2">data.frame</span></span>(<span class="fc2">&quot;mtry&quot;</span>=<span class="fc3">27</span>),<span class="fc1">trControl=</span>train_control)</div><div class="t m0 x2 h5 y7f ff6 fs1 fc4 sc0 ls0 ws0">#expected<span class="_ _3"> </span>test<span class="_ _3"> </span>error<span class="_ _3"> </span>based<span class="_ _3"> </span>on<span class="_ _3"> </span>CV<span class="_ _3"> </span>error</div><div class="t m0 x2 h3 y80 ff3 fs1 fc3 sc0 ls0 ws0">100<span class="fc0">*(</span>1<span class="fc0">-<span class="ff2 fc1">mean</span>(rf.model.final$resample$Accuracy))</span></div><div class="t m0 x2 h3 y81 ff3 fs1 fc0 sc0 ls0 ws0">##<span class="_ _3"> </span>[1]<span class="_ _3"> </span>0.4994255</div><div class="t m0 x2 h4 y82 ff4 fs1 fc0 sc0 ls0 ws0">Here<span class="_ _7"> </span>are<span class="_ _6"> </span>the<span class="_ _6"> </span>actual<span class="_ _6"> </span>predictions<span class="_ _6"> </span>for<span class="_ _6"> </span>the<span class="_ _6"> </span>test<span class="_ _6"> </span>set:</div><div class="t m0 x2 h3 y83 ff3 fs1 fc0 sc0 ls0 ws0">test.pred&lt;-<span class="ff2 fc1">predict</span>(rf.model.final,<span class="fc1">newdata=</span>test.feat)</div><div class="t m0 x2 h3 y84 ff2 fs1 fc1 sc0 ls0 ws0">as.character<span class="ff3 fc0">(test.pred)</span></div><div class="t m0 x2 h3 y85 ff3 fs1 fc0 sc0 ls0 ws0">##<span class="_ _10"> </span>[1]<span class="_ _3"> </span>&quot;B&quot;<span class="_ _3"> </span>&quot;A&quot;<span class="_ _3"> </span>&quot;B&quot;<span class="_ _3"> </span>&quot;A&quot;<span class="_ _3"> </span>&quot;A&quot;<span class="_ _3"> </span>&quot;E&quot;<span class="_ _3"> </span>&quot;D&quot;<span class="_ _3"> </span>&quot;B&quot;<span class="_ _3"> </span>&quot;A&quot;<span class="_ _3"> </span>&quot;A&quot;<span class="_ _3"> </span>&quot;B&quot;<span class="_ _3"> </span>&quot;C&quot;<span class="_ _3"> </span>&quot;B&quot;<span class="_ _3"> </span>&quot;A&quot;<span class="_ _3"> </span>&quot;E&quot;<span class="_ _3"> </span>&quot;E&quot;<span class="_ _3"> </span>&quot;A&quot;</div><div class="t m0 x2 h3 y86 ff3 fs1 fc0 sc0 ls0 ws0">##<span class="_ _3"> </span>[18]<span class="_ _3"> </span>&quot;B&quot;<span class="_ _3"> </span>&quot;B&quot;<span class="_ _3"> </span>&quot;B&quot;</div><div class="t m0 x3 h4 y30 ff4 fs1 fc0 sc0 ls0 ws0">3</div></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div></div>
</div>
<div class="loading-indicator">

</div>
</body>
</html>
